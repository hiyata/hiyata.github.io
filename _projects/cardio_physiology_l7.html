---
layout: default
title: ECG Basics — Rate, Rhythm, Axis
---

<div id="ecg-app" style="max-width:1400px;margin:0 auto;padding:1.25rem"></div>

<!-- React + ReactDOM (UMD) -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script crossorigin src="https://unpkg.com/react-is@18/umd/react-is.development.js"></script>

<!-- Recharts (UMD) -->
<script crossorigin src="https://unpkg.com/recharts/umd/Recharts.js"></script>

<!-- Babel (compile JSX in the browser) -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
  :root{--ink:#0f172a;--muted:#64748b;--grid:#e5e7eb;--strong:#cbd5e1;--green:#059669;--red:#dc2626;--blue:#2563eb;}
  body{color:var(--ink)}
  .wrap{display:grid;grid-template-columns:1fr;gap:24px;max-width:100%;}
  @media(min-width:1024px){.wrap{grid-template-columns:minmax(320px, 420px) 1fr;gap:32px}}
  .section h2{font:600 12px/1.1 ui-sans-serif,system-ui;letter-spacing:.08em;text-transform:uppercase;color:var(--muted);margin:0 0 8px}
  .stack{display:flex;flex-direction:column;gap:12px}
  .row{display:flex;gap:12px;align-items:center}
  .flex1{flex:1}
  .field{display:flex;flex-direction:column;gap:6px}
  .label{font-size:12px;color:var(--muted)}
  input[type="range"]{width:100%}
  input[type="number"],select,button{border:1px solid var(--grid);border-radius:6px;padding:6px 8px;font-size:14px}
  button{cursor:pointer;background:#fff}
  button:hover{background:#f8fafc}
  button.primary{background:var(--blue);color:white;font-weight:600}
  button.primary:hover{background:#1d4ed8}
  .mode-toggle{display:flex;gap:0;border:1px solid var(--grid);border-radius:6px;overflow:hidden;margin-bottom:16px}
  .mode-toggle button{border:none;border-radius:0;padding:8px 16px;background:white}
  .mode-toggle button.active{background:var(--blue);color:white}
  .legend{display:flex;gap:16px;align-items:center;margin:6px 0 10px;font-size:14px}
  .pill{display:inline-flex;gap:8px;align-items:center}
  .pill .line{width:32px;height:2px;background:var(--ink);display:inline-block}
  .pill .dash{width:32px;height:0;border-top:2px dashed #94a3b8;display:inline-block}
  .divider{height:1px;background:var(--grid);margin:12px 0}

  /* ECG paper background (1 mm small, 5 mm bold). Uses CSS scaling so it "looks right". */
  .ecg-paper{
    position:relative;
    border:1px solid #f1c9c9;
    background:
      linear-gradient(0deg, rgba(200,0,0,0.08) 1px, transparent 1px) 0 0 / 8px 8px,
      linear-gradient(90deg, rgba(200,0,0,0.08) 1px, transparent 1px) 0 0 / 8px 8px,
      linear-gradient(0deg, rgba(200,0,0,0.25) 1px, transparent 1px) 0 0 / 40px 40px,
      linear-gradient(90deg, rgba(200,0,0,0.25) 1px, transparent 1px) 0 0 / 40px 40px,
      #fff5f5;
    border-radius:8px;
  }
  .ecg-strip{height:220px}
  .hr-bad{color:var(--red);font-weight:600}
  .answer-btn{border:1px solid var(--grid);border-radius:6px;padding:8px 10px}
  .answer-btn.selected{outline:2px solid var(--blue); background:#eef2ff}
  .answer-btn.correct{border-color:var(--green); background:#f0fdf4}
  .answer-btn.incorrect{border-color:var(--red); background:#fef2f2}
  .muted{color:var(--muted)}
</style>

{% raw %}
<script type="text/babel" data-presets="env,react">
const {useMemo,useState,useRef} = React;
const {LineChart,Line,CartesianGrid,XAxis,YAxis,Tooltip,ReferenceLine,ResponsiveContainer} = Recharts;

/** ----------------- Helpers ----------------- **/
const clamp = (v,lo,hi)=>Math.max(lo,Math.min(hi,v));

/* Simple gaussian waves to synthesize an ECG lead II beat */
function gauss(x, mu, sigma, amp){ const z=(x-mu)/sigma; return amp*Math.exp(-0.5*z*z); }

/** Build a synthetic ECG strip (Lead II style) with given intervals.
 *  rr, pr, qrs, qt in ms. fs in Hz. returns [{t: seconds, v: mV}]
 */
function generateECG({rr, pr, qrs, qt, beats=3, fs=500}){
  rr = clamp(rr, 300, 2000);   // 30–200 bpm
  pr = clamp(pr, 100, 260);
  qrs = clamp(qrs, 70, 160);
  qt = clamp(qt, 280, 520);
  const dt = 1000/fs;

  const oneBeat = [];
  const nBeat = Math.round(rr/dt);
  for(let i=0;i<nBeat;i++){
    const t = i*dt;
    const pCenter = Math.max(0.11*rr, pr - 0.5*qrs);
    const qrsC = pr;
    const tStart = qrsC + qrs;
    const tCenter = tStart + 0.45*(qt - qrs);

    // widths scale with intervals
    const pS = 0.05*rr;
    const qS = 0.10*qrs, rS=0.08*qrs, sS=0.10*qrs;
    const tS = 0.22*(qt - qrs);

    let v=0;
    v += gauss(t,pCenter,pS, 0.12);          // P
    v += gauss(t,qrsC-0.22*qrs, qS, -0.25);  // Q
    v += gauss(t,qrsC,          rS,  1.00);  // R
    v += gauss(t,qrsC+0.28*qrs, sS, -0.35);  // S
    v += gauss(t,tCenter,       tS,  0.35);  // T

    oneBeat.push(v);
  }
  // zero-mean for isoelectric baseline
  const mean = oneBeat.reduce((a,b)=>a+b,0)/oneBeat.length;
  for(let i=0;i<oneBeat.length;i++) oneBeat[i]-=mean;

  const data=[];
  for(let b=0;b<beats;b++){
    for(let i=0;i<nBeat;i++){
      const t_ms = b*rr + i*dt;
      data.push({ t: +(t_ms/1000).toFixed(3), v: oneBeat[i] });
    }
  }
  return data;
}

/** Map “teaching metrics” → intervals (education-only heuristics) */
function makeIntervals({bpm=60, pr=160, qrs=90, qt=400}){
  const rr = clamp(60000/ clamp(bpm,30,200), 300, 2000);
  return { rr, pr, qrs, qt };
}

/** HR by big-box rule (300-150-100-75-60-50 …) given RR in ms */
function hrFromRRBigBox(rr_ms){
  const hr = 60000/rr_ms;
  return Math.round(hr);
}

/** ----------------- ECG Paper toggles ----------------- **/
function PaperWrap({showPaper, children, height=220}){
  return (
    <div className={showPaper ? 'ecg-paper ecg-strip' : 'ecg-strip'} style={{height}}>
      {children}
    </div>
  );
}

/** ----------------- Explore Page ----------------- **/
function Explore(){
  const [bpm,setBpm]=useState(60);
  const [pr,setPr]=useState(160);
  const [qrs,setQrs]=useState(90);
  const [qt,setQt]=useState(400);
  const [showPaper,setShowPaper]=useState(true);
  const [showAxes,setShowAxes]=useState(false);
  const [showBaseline,setShowBaseline]=useState(true);

  // Baseline “normal” for comparison
  const base = useMemo(()=>makeIntervals({bpm:60, pr:160, qrs:90, qt:400}),[]);
  const cur  = useMemo(()=>makeIntervals({bpm, pr, qrs, qt}),[bpm,pr,qrs,qt]);

  const baseECG = useMemo(()=>generateECG({...base, beats:3, fs:500}),[base]);
  const curECG  = useMemo(()=>generateECG({...cur,  beats:3, fs:500}),[cur]);

  const hr = useMemo(()=>hrFromRRBigBox(cur.rr),[cur.rr]);

  return (
    <div className="wrap">
      <section className="section">
        <h2>Explore — Build an ECG</h2>
        <div className="stack">
          <div className="row">
            <div className="field flex1">
              <label className="label">Heart Rate (BPM): {bpm}</label>
              <input type="range" min="30" max="180" step="1" value={bpm} onChange={e=>setBpm(+e.target.value)}/>
            </div>
            <div className="field" style={{width:120}}>
              <label className="label">BPM</label>
              <input type="number" min="30" max="180" value={bpm} onChange={e=>setBpm(clamp(+e.target.value||0,30,180))}/>
            </div>
          </div>

          <div className="row">
            <div className="field flex1">
              <label className="label">PR (ms): {pr}</label>
              <input type="range" min="100" max="260" step="5" value={pr} onChange={e=>setPr(+e.target.value)}/>
            </div>
            <div className="field flex1">
              <label className="label">QRS (ms): {qrs}</label>
              <input type="range" min="70" max="160" step="5" value={qrs} onChange={e=>setQrs(+e.target.value)}/>
            </div>
            <div className="field flex1">
              <label className="label">QT (ms): {qt}</label>
              <input type="range" min="280" max="520" step="5" value={qt} onChange={e=>setQt(+e.target.value)}/>
            </div>
          </div>

          <div className="row">
            <label className="label"><input type="checkbox" checked={showPaper} onChange={e=>setShowPaper(e.target.checked)}/> Show ECG paper</label>
            <label className="label"><input type="checkbox" checked={showAxes} onChange={e=>setShowAxes(e.target.checked)}/> Show axes & tooltip</label>
            <label className="label"><input type="checkbox" checked={showBaseline} onChange={e=>setShowBaseline(e.target.checked)}/> Show baseline overlay</label>
          </div>

          <div className="divider"></div>

          <div className="muted" style={{fontSize:13}}>
            ECG gives rate, rhythm, and axis—not blood pressure directly. Use the grid to estimate rate
            (each big box is 0.20 s; the quick rule 300–150–100–75–60–50) and watch PR/QRS/QT for conduction/ion-channel effects. 
          </div>
        </div>
      </section>

      <section className="section">
        <h2>Lead II (synthetic) — compare to baseline</h2>
        <div className="legend">
          <span className="pill"><span className="line"></span> Current</span>
          <span className="pill"><span className="dash"></span> Baseline (60 bpm | PR160 | QRS90 | QT400)</span>
        </div>

        <PaperWrap showPaper={showPaper} height={240}>
          <ResponsiveContainer width="100%" height="100%">
            <LineChart data={curECG} margin={{top:12,right:20,bottom:20,left:20}}>
              {showAxes && (
                <>
                  <CartesianGrid strokeDasharray="3 3" />
                  <XAxis type="number" dataKey="t" domain={[0,'dataMax']} tickCount={8}
                         label={{value:'time (s)', position:'insideBottomRight', offset:-10}}/>
                  <YAxis domain={[-1.2,1.4]} tickCount={5}
                         label={{value:'mV', angle:-90, position:'insideLeft'}}/>
                  <Tooltip formatter={(v)=>`${Number(v).toFixed(2)} mV`} labelFormatter={(l)=>`${Number(l).toFixed(2)} s`} />
                </>
              )}
              {showBaseline && (
                <Line dot={false} type="monotone" dataKey="v" data={baseECG} name="Baseline" stroke="#94a3b8" strokeWidth={2} strokeDasharray="6 4"/>
              )}
              <Line dot={false} type="monotone" dataKey="v" stroke="#0f172a" strokeWidth={2.5}/>
              <ReferenceLine y={0} stroke="rgba(0,0,0,0.15)"/>
            </LineChart>
          </ResponsiveContainer>
        </PaperWrap>

        <div className="row" style={{marginTop:10,justifyContent:'space-between'}}>
          <div>Est. HR (big-box rule): <strong>{hr} bpm</strong></div>
          <div className="muted">PR: {pr} ms · QRS: {qrs} ms · QT: {qt} ms</div>
        </div>
      </section>
    </div>
  );
}

/** ----------------- Quiz Page (no answer leak) ----------------- **/
function HRQuiz(){
  // build random strips with integer big-box RR spacing (for teaching the 300-150-100-75-60-50 rule)
  const options = ["~300","~150","~100","~75","~60","~50","Other"];
  const [showPaper,setShowPaper]=useState(true);
  const [showAxes,setShowAxes]=useState(false);

  const makeCase = ()=>{
    // choose target from the quick sequence by picking 1–6 big boxes ± jitter
    const boxes = [1,2,3,4,5,6][Math.floor(Math.random()*6)];
    const bpmQuick = [300,150,100,75,60,50][boxes-1];
    const rr = boxes*200; // 0.2 s per big box
    // add tiny jitter so it’s not perfectly aligned
    const rrJitter = rr + (Math.random()*40-20); // ±20 ms
    const pr = 140 + Math.floor(Math.random()*60); // 140–200 ms
    const qrs = 80 + Math.floor(Math.random()*30); // 80–110 ms
    const qt = 360 + Math.floor(Math.random()*80); // 360–440 ms
    const data = generateECG({rr:rrJitter, pr, qrs, qt, beats:3, fs:500});
    return {data, rr:rrJitter, bpmQuick};
  };

  const [question,setQuestion]=useState(makeCase());
  const [selected,setSelected]=useState(null);
  const [checked,setChecked]=useState(false);
  const [correct,setCorrect]=useState(false);

  function check(){
    if(selected==null) return;
    const hr = Math.round(60000/question.rr);
    // map to the same buckets used in labels
    const bucket = hr>=275?0: hr>=125?1: hr>=88?2: hr>=68?3: hr>=55?4: hr>=45?5:6;
    const ok = options[bucket]===selected;
    setCorrect(ok);
    setChecked(true);
  }
  function next(){
    setQuestion(makeCase());
    setSelected(null);
    setChecked(false);
    setCorrect(false);
  }

  return (
    <div className="stack">
      <div className="row" style={{gap:16}}>
        <h3 style={{margin:0, fontWeight:700}}>HR Quiz — What’s the heart rate?</h3>
        <label className="label"><input type="checkbox" checked={showPaper} onChange={e=>setShowPaper(e.target.checked)}/> ECG paper</label>
        <label className="label"><input type="checkbox" checked={showAxes} onChange={e=>setShowAxes(e.target.checked)}/> Axes</label>
      </div>

      <PaperWrap showPaper={showPaper} height={200}>
        <ResponsiveContainer width="100%" height="100%">
          <LineChart data={question.data} margin={{top:12,right:20,bottom:20,left:20}}>
            {showAxes && (
              <>
                <CartesianGrid strokeDasharray="3 3" />
                <XAxis type="number" dataKey="t" domain={[0,'dataMax']} tickCount={8}
                       label={{value:'time (s)', position:'insideBottomRight', offset:-10}}/>
                <YAxis domain={[-1.2,1.4]} tickCount={5}
                       label={{value:'mV', angle:-90, position:'insideLeft'}}/>
                <Tooltip formatter={(v)=>`${Number(v).toFixed(2)} mV`} labelFormatter={(l)=>`${Number(l).toFixed(2)} s`} />
              </>
            )}
            <Line dot={false} type="monotone" dataKey="v" stroke="#0f172a" strokeWidth={2.5}/>
            <ReferenceLine y={0} stroke="rgba(0,0,0,0.15)"/>
          </LineChart>
        </ResponsiveContainer>
      </PaperWrap>

      <div className="row" style={{flexWrap:'wrap', gap:8}}>
        {options.map(opt=>{
          const isSel = selected===opt;
          const cls = ["answer-btn", isSel?"selected":"", checked && isSel && (correct?"correct":"incorrect")].join(" ");
          return (
            <button key={opt} className={cls} onClick={()=>!checked && setSelected(opt)}>
              {opt} bpm
            </button>
          );
        })}
      </div>

      <div className="row" style={{gap:8}}>
        <button className="primary" onClick={check} disabled={checked || selected==null}>Check Answer</button>
        {checked && (
          <>
            <span style={{fontWeight:700, color: correct? 'var(--green)':'var(--red)'}}>
              {correct ? '✓ Correct' : '✗ Not quite'}
            </span>
            <button onClick={next}>Next</button>
          </>
        )}
      </div>

      {checked && (
        <div className="muted">
          Tip: Use the big-box rule (each big box = 0.20 s): 300, 150, 100, 75, 60, 50… :contentReference[oaicite:0]{index=0}
        </div>
      )}
    </div>
  );
}

function Quiz(){
  return (
    <div className="wrap">
      <section className="section" style={{gridColumn:'1 / -1'}}>
        <h2>Practice — Rate & Rhythm</h2>
        <div className="stack">
          <HRQuiz/>
          <div className="divider"></div>
          <div className="muted" style={{fontSize:13}}>
            You’ll learn axis separately (quick method: biggest QRS ≈ parallel to MEA; most isoelectric ≈ perpendicular). 
            Normal axis −30° to +90°. :contentReference[oaicite:1]{index=1} :contentReference[oaicite:2]{index=2}
          </div>
        </div>
      </section>
    </div>
  );
}

/** ----------------- Main App ----------------- **/
function App(){
  const [mode,setMode]=useState('explore');
  return (
    <>
      <div className="mode-toggle">
        <button className={mode==='explore'?'active':''} onClick={()=>setMode('explore')}>Explore</button>
        <button className={mode==='quiz'?'active':''} onClick={()=>setMode('quiz')}>Quiz</button>
      </div>
      {mode==='explore' ? <Explore/> : <Quiz/>}
    </>
  );
}

ReactDOM.createRoot(document.getElementById('ecg-app')).render(<App/>);
</script>
{% endraw %}
